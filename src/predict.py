import pickle
import pandas as pd
from src.train import PreprossesData
from src.validate import ValidateData

with open('../data/clf_model.pkl', 'rb') as f:
    clf = pickle.load(f)

test_df = pd.read_csv("../data/test.tsv", sep='\t')

X_test = test_df

prep = PreprossesData()
X_test = prep.extract_features(X_test).iloc[:, 1:]

y_test_pred = clf.predict(X_test)

pd.Series(y_test_pred, name='prediction').to_csv('prediction.txt', index=False)

validate = ValidateData()
validate.predict_explain(clf, X_test)
